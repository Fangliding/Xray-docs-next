import{r as n,o as e,c as s,a,b as t,F as o,e as c}from"./app.f9f5aa77.js";const l={},r=a("h1",{id:"chapter-6-certificate-management",tabindex:"-1"},[a("a",{class:"header-anchor",href:"#chapter-6-certificate-management","aria-hidden":"true"},"#"),c(" [Chapter 6] Certificate Management")],-1),i=a("h2",{id:"_6-1-applying-for-a-tls-certificate",tabindex:"-1"},[a("a",{class:"header-anchor",href:"#_6-1-applying-for-a-tls-certificate","aria-hidden":"true"},"#"),c(" 6.1 Applying for a TLS Certificate")],-1),p=a("p",null,"Next, we need to apply for a real TLS certificate for our domain name, so that the website has the ability to encrypt with standard TLS and the ability to access via HTTPS. This is the most important tool for Xray and other current security proxy tools to ensure fully encrypted traffic.",-1),u=a("div",{class:"custom-container warning"},[a("p",{class:"custom-container-title"},"Warning"),a("p",null,"Please do not use self-signed certificates lightly. It does not make the operation much simpler, but adds unnecessary risks (such as man-in-the-middle attacks).")],-1),m=c("Here, I will use a certificate management tool called "),b={href:"https://github.com/acmesh-official/acme.sh",target:"_blank",rel:"noopener noreferrer"},d=a("code",null,"acme.sh",-1),k=c(", which is simple, lightweight, efficient, and capable of automatically updating certificates."),h=a("p",null,"In addition, I believe that you have gradually become familiar with the basic operations of Linux. Therefore, from this chapter on, commands that have appeared multiple times will no longer have screenshots and will only be briefly described. If you really can't remember how to use them, just review the previous chapters.",-1),f=a("h2",{id:"_6-2-install-acme-sh",tabindex:"-1"},[a("a",{class:"header-anchor",href:"#_6-2-install-acme-sh","aria-hidden":"true"},"#"),c(" 6.2 Install "),a("code",null,"acme.sh")],-1),g=a("ol",null,[a("li",null,[a("p",null,"Basic Linux commands for beginners:"),a("table",null,[a("thead",null,[a("tr",null,[a("th",{style:{"text-align":"center"}},"Number"),a("th",{style:{"text-align":"center"}},"Command"),a("th",{style:{"text-align":"center"}},"Description")])]),a("tbody",null,[a("tr",null,[a("td",{style:{"text-align":"center"}},[a("code",null,"cmd-12")]),a("td",{style:{"text-align":"center"}},[a("code",null,"wget")]),a("td",{style:{"text-align":"center"}},"Retrieve (or download) a webpage file")]),a("tr",null,[a("td",{style:{"text-align":"center"}},[a("code",null,"cmd-13")]),a("td",{style:{"text-align":"center"}},[a("code",null,"acme.sh")]),a("td",{style:{"text-align":"center"}},"Commands related to acme.sh certificate management")])])])]),a("li",null,[a("p",null,"Run the installation script.")])],-1),y=a("div",{class:"language-bash ext-sh line-numbers-mode"},[a("pre",{class:"language-bash"},[a("code",null,[a("span",{class:"token function"},"wget"),c(" -O - https://get.acme.sh "),a("span",{class:"token operator"},"|"),c(),a("span",{class:"token function"},"sh"),c("\n")])]),a("div",{class:"line-numbers"},[a("span",{class:"line-number"},"1"),a("br")])],-1),v=a("ol",{start:"3"},[a("li",null,[c("Make the "),a("code",null,"acme.sh"),c(" command effective.")])],-1),w=a("div",{class:"language-bash ext-sh line-numbers-mode"},[a("pre",{class:"language-bash"},[a("code",null,[a("span",{class:"token builtin class-name"},"."),c(" .bashrc\n")])]),a("div",{class:"line-numbers"},[a("span",{class:"line-number"},"1"),a("br")])],-1),E=a("p",null,[c("(Note: This command is used to source (load) the "),a("code",null,".bashrc"),c(" file in the shell environment.)")],-1),T=a("ol",{start:"4"},[a("li",null,[c("Enable "),a("code",null,"acme.sh"),c(" automatic upgrade.")])],-1),M=a("div",{class:"language-bash ext-sh line-numbers-mode"},[a("pre",{class:"language-bash"},[a("code",null,"acme.sh --upgrade --auto-upgrade\n")]),a("div",{class:"line-numbers"},[a("span",{class:"line-number"},"1"),a("br")])],-1),C=a("ol",{start:"5"},[a("li",null,"The complete process up to this point is shown in the following diagram:")],-1),A=a("p",null,[a("img",{src:"/Xray-docs-next/assets/ch06-img01-acme-install.809938be.gif",alt:"acme.sh installation demo"})],-1),x=a("h2",{id:"_6-3-testing-certificate-application",tabindex:"-1"},[a("a",{class:"header-anchor",href:"#_6-3-testing-certificate-application","aria-hidden":"true"},"#"),c(" 6.3 Testing Certificate Application")],-1),S=a("p",null,[c("Before officially applying for the certificate, we use the testing command ("),a("code",null,"--issue --test"),c(") to verify if the application can be successfully submitted. This can avoid repeated failures in applying for a certificate due to incorrect local configuration, exceeding the frequency limit of Let's Encrypt (such as a maximum of 5 failures per hour, per domain, or per user), which may prevent the subsequent steps from being carried out.")],-1),D=a("ol",null,[a("li",null,"The command to apply for a test certificate is as follows (this article uses ECC certificate as an example, because there is really no reason not to use it nowadays):")],-1),I=a("div",{class:"language-bash ext-sh line-numbers-mode"},[a("pre",{class:"language-bash"},[a("code",null,"acme.sh --issue --server letsencrypt --test -d subdomain.yourdomain.com -w /home/vpsadmin/www/webpage --keylength ec-256\n")]),a("div",{class:"line-numbers"},[a("span",{class:"line-number"},"1"),a("br")])],-1),W=a("p",null,"(Note: This is a command in shell script for obtaining SSL certificate from Let's Encrypt CA using ACME protocol. It specifies the test server, the subdomain for which the certificate is requested, the webroot directory of the subdomain, and the key length to use for the certificate.)",-1),P=a("div",{class:"custom-container warning"},[a("p",{class:"custom-container-title"},"Explanation"),a("p",null,[c("The main advantage of the "),a("code",null,"ECC"),c(" certificate is that its "),a("code",null,"Keysize"),c(" is smaller, which means that security is improved and encryption and decryption speed is faster for the same size. Why not choose ECC-256bit, which is approximately equivalent to RSA-3072bit in strength? Of course, some people say that the ECC certificate handshake is significantly faster, which I think is a bit exaggerated, because RSA handshake is not too slow either. Even if there is a difference, it should be in milliseconds and difficult to perceive directly.")]),a("p",null,"In addition, if some websites do need to be compatible with certain old devices, please still choose RSA certificates according to your needs."),a("ol",{start:"2"},[a("li",null,"You should eventually see a prompt similar to this:")]),a("div",{class:"language-log ext-log line-numbers-mode"},[a("pre",{class:"language-log"},[a("code",null,[a("span",{class:"token punctuation"},"["),a("span",{class:"token date number"},"Wed 30"),c(" Dec "),a("span",{class:"token number"},"2022"),c(),a("span",{class:"token time number"},"04:25:12"),c(" AM EST"),a("span",{class:"token punctuation"},"]"),c(),a("span",{class:"token property"},"Using ACME_DIRECTORY:"),c(),a("span",{class:"token url"},"https://acme-staging-v02.api.letsencrypt.org/directory"),c("\n"),a("span",{class:"token punctuation"},"["),a("span",{class:"token date number"},"Wed 30"),c(" Dec "),a("span",{class:"token number"},"2022"),c(),a("span",{class:"token time number"},"04:25:13"),c(" AM EST"),a("span",{class:"token punctuation"},"]"),c(),a("span",{class:"token property"},"Using CA:"),c(),a("span",{class:"token url"},"https://acme-staging-v02.api.letsencrypt.org/directory"),c("\n"),a("span",{class:"token punctuation"},"["),a("span",{class:"token date number"},"Wed 30"),c(" Dec "),a("span",{class:"token number"},"2022"),c(),a("span",{class:"token time number"},"04:25:13"),c(" AM EST"),a("span",{class:"token punctuation"},"]"),c(" Create account key ok"),a("span",{class:"token punctuation"},"."),c("\n"),a("span",{class:"token punctuation"},"["),a("span",{class:"token date number"},"Wed 30"),c(" Dec "),a("span",{class:"token number"},"2022"),c(),a("span",{class:"token time number"},"04:25:13"),c(" AM EST"),a("span",{class:"token punctuation"},"]"),c(),a("span",{class:"token property"},"Registering account:"),c(),a("span",{class:"token url"},"https://acme-staging-v02.api.letsencrypt.org/directory"),c("\n"),a("span",{class:"token punctuation"},"["),a("span",{class:"token date number"},"Wed 30"),c(" Dec "),a("span",{class:"token number"},"2022"),c(),a("span",{class:"token time number"},"04:25:13"),c(" AM EST"),a("span",{class:"token punctuation"},"]"),c(" Registered\n"),a("span",{class:"token punctuation"},"["),a("span",{class:"token date number"},"Wed 30"),c(" Dec "),a("span",{class:"token number"},"2022"),c(),a("span",{class:"token time number"},"04:25:13"),c(" AM EST"),a("span",{class:"token punctuation"},"]"),c(" ACCOUNT_THUMBPRINT"),a("span",{class:"token operator"},"="),a("span",{class:"token string"},"'CU6qmPKuRqhyTAIrF4swosR375194z_1ddUlWef8xDc'"),c("\n"),a("span",{class:"token punctuation"},"["),a("span",{class:"token date number"},"Wed 30"),c(" Dec "),a("span",{class:"token number"},"2022"),c(),a("span",{class:"token time number"},"04:25:13"),c(" AM EST"),a("span",{class:"token punctuation"},"]"),c(" Creating domain key\n"),a("span",{class:"token punctuation"},"["),a("span",{class:"token date number"},"Wed 30"),c(" Dec "),a("span",{class:"token number"},"2022"),c(),a("span",{class:"token time number"},"04:25:13"),c(" AM EST"),a("span",{class:"token punctuation"},"]"),c(),a("span",{class:"token property"},"The domain key is here:"),c(),a("span",{class:"token file-path string"},"/home/vpsadmin/.acme.sh/二级域名.你的域名.com_ecc/二级域名.你的域名.com.key"),c("\n"),a("span",{class:"token punctuation"},"["),a("span",{class:"token date number"},"Wed 30"),c(" Dec "),a("span",{class:"token number"},"2022"),c(),a("span",{class:"token time number"},"04:25:13"),c(" AM EST"),a("span",{class:"token punctuation"},"]"),c(" Single domain"),a("span",{class:"token operator"},"="),a("span",{class:"token string"},"'二级域名.你的域名.com'"),c("\n"),a("span",{class:"token punctuation"},"["),a("span",{class:"token date number"},"Wed 30"),c(" Dec "),a("span",{class:"token number"},"2022"),c(),a("span",{class:"token time number"},"04:25:13"),c(" AM EST"),a("span",{class:"token punctuation"},"]"),c(" Getting domain auth token for each domain\n"),a("span",{class:"token punctuation"},"["),a("span",{class:"token date number"},"Wed 30"),c(" Dec "),a("span",{class:"token number"},"2022"),c(),a("span",{class:"token time number"},"04:25:14"),c(" AM EST"),a("span",{class:"token punctuation"},"]"),c(" Getting webroot for domain"),a("span",{class:"token operator"},"="),a("span",{class:"token string"},"'二级域名.你的域名.com'"),c("\n"),a("span",{class:"token punctuation"},"["),a("span",{class:"token date number"},"Wed 30"),c(" Dec "),a("span",{class:"token number"},"2022"),c(),a("span",{class:"token time number"},"04:25:14"),c(" AM EST"),a("span",{class:"token punctuation"},"]"),c(),a("span",{class:"token property"},"Verifying:"),c(" 二级域名"),a("span",{class:"token punctuation"},"."),c("你的域名"),a("span",{class:"token punctuation"},"."),c("com\n"),a("span",{class:"token punctuation"},"["),a("span",{class:"token date number"},"Wed 30"),c(" Dec "),a("span",{class:"token number"},"2022"),c(),a("span",{class:"token time number"},"04:25:23"),c(" AM EST"),a("span",{class:"token punctuation"},"]"),c(" Pending\n"),a("span",{class:"token punctuation"},"["),a("span",{class:"token date number"},"Wed 30"),c(" Dec "),a("span",{class:"token number"},"2022"),c(),a("span",{class:"token time number"},"04:25:25"),c(" AM EST"),a("span",{class:"token punctuation"},"]"),c(" Success\n"),a("span",{class:"token punctuation"},"["),a("span",{class:"token date number"},"Wed 30"),c(" Dec "),a("span",{class:"token number"},"2022"),c(),a("span",{class:"token time number"},"04:25:25"),c(" AM EST"),a("span",{class:"token punctuation"},"]"),c(" Verify finished"),a("span",{class:"token punctuation"},","),c(" start to sign"),a("span",{class:"token punctuation"},"."),c("\n"),a("span",{class:"token punctuation"},"["),a("span",{class:"token date number"},"Wed 30"),c(" Dec "),a("span",{class:"token number"},"2022"),c(),a("span",{class:"token time number"},"04:25:25"),c(" AM EST"),a("span",{class:"token punctuation"},"]"),c(" Lets finalize the order"),a("span",{class:"token punctuation"},"."),c("\n"),a("span",{class:"token punctuation"},"["),a("span",{class:"token date number"},"Wed 30"),c(" Dec "),a("span",{class:"token number"},"2022"),c(),a("span",{class:"token time number"},"04:25:25"),c(" AM EST"),a("span",{class:"token punctuation"},"]"),c(" Le_OrderFinalize"),a("span",{class:"token operator"},"="),a("span",{class:"token string"},"'https://acme-staging-v02.api.letsencrypt.org/acme/finalize/490205995/7730242871'"),c("\n"),a("span",{class:"token punctuation"},"["),a("span",{class:"token date number"},"Wed 30"),c(" Dec "),a("span",{class:"token number"},"2022"),c(),a("span",{class:"token time number"},"04:25:25"),c(" AM EST"),a("span",{class:"token punctuation"},"]"),c(" Downloading cert"),a("span",{class:"token punctuation"},"."),c("\n"),a("span",{class:"token punctuation"},"["),a("span",{class:"token date number"},"Wed 30"),c(" Dec "),a("span",{class:"token number"},"2022"),c(),a("span",{class:"token time number"},"04:25:25"),c(" AM EST"),a("span",{class:"token punctuation"},"]"),c(" Le_LinkCert"),a("span",{class:"token operator"},"="),a("span",{class:"token string"},"'https://acme-staging-v02.api.letsencrypt.org/acme/cert/xujss5xt8i38waubafz2xujss5xt8i38waubz2'"),c("\n"),a("span",{class:"token punctuation"},"["),a("span",{class:"token date number"},"Wed 30"),c(" Dec "),a("span",{class:"token number"},"2022"),c(),a("span",{class:"token time number"},"15:21:52"),c(" AM EST"),a("span",{class:"token punctuation"},"]"),c(" Cert success"),a("span",{class:"token punctuation"},"."),c("\n"),a("span",{class:"token operator"},"-"),a("span",{class:"token operator"},"-"),c("BEGIN CERTIFICAT"),a("span",{class:"token operator"},"-"),a("span",{class:"token operator"},"-"),c("\nsxlYqPvWreKgD5b8JyOQX0Yg2MLoRUoDyqVkd31PthIiwzdckoh5eD3JU7ysYBtN\ncTFK4LGOfjqi8Ks87EVJdK9IaSAu7ZC6h5to0eqpJ5PLhaM3e6yJBbHmYA8w1Smp\nwAb3tdoHZ9ttUIm9CrSzvDBt6BBT6GqYdDamMyCYBLooMyDEM4CUFsOzCRrEqqvC\n2mTTEmhvpojo5rhdTSJxibozyNWTGwoTj0v9pTUeQcGqLIzqi4DowjBHD5guwRid\nSjAFnm6JT2xUQgWFm58A1gv1OhbH1TRPUUmtE1nFEN7YiSjI4xgxqAXT3CLD2EUb\nwXlUrO6c75zSsQP4bRMzgOjJUqHtSb6IEqELzt4M7KzL5iCOruCChCo2DZxUwvVX\ntOoaAyQJzCbTqE6aUqwiKi3gVyoxvDP9mI5JdRYzsDL6GVud7EHPnYeMl9ubLZAK\n0vg84mbMP3f6mYM4KRa1cqiyOIcQPT4AzGFYVv4sm049bZQg7sd0Bz9CaFvE7yDA\n1y17XlgCDnsjxl66bqI1vkENN9XT5xeFHONqc18b5fZEKSIvdX7iWPFWp1PyMPpG\n0pMCP1EymZNFxIMJLgbWqExwLWfPc5Ib3PjBaIqhXPnw6sT2MQSxXwDupq1UJVhV\n7E3hQRVlwI4CXi6WLHJMNvNRyyK87gCrLH1bKYsPeRVaz77poWBq49zwBCts6hPY\nIeF4ltGXyANNIOPEi8vy138fRU4LYh81d8FjOtFfJZogMjwhfNvapqxPMsioPlmX\nTnZu0n7setrVNUEfTMHWqPpDgk5MPrWLA4LapqaDfEX4pwnQJLMwMi6s94z165c0\niMRSKA1yU5zqv8aNsDfPoY4OkSPWs4MaXgRRSLBsUfZ15DwQXPk76kegHIyxWvwF\ntYw9HKR5QCMK66fa0z4aJoFVFLK0IIOGEZOanRFUCnkLUDd3QZ3YU8lEcrj7Uxos\nhaiRNICyC6UfsCJ94a8vcNyMosPv3xBLMp19WXgiFYqEFQkntkv1FLRI35fjeJmg\n0fmD9VG9bkzGPHihJgQLRlCHasGf6XrdfkSsODAyCUHUHJ0RzqF4YEZMcxDxzuQ2\nYO7bFwj7S3mUdVPZ6MPasjxdyBjJgEBMch2uy4AhmudXfEBQBye8W6ZI4ztZjLVV\nFmP4SIuaNUmMe20TjR8b9NVC96AhxOanWT3mRROsdokpKQGTJvl27EHH8KuAbUOc\nG6KtPy4wslNZNXWcBy9n63RcWak12r7kAIFn38tZxmlw2WUKoRSMAH64GcDTjRQd\nAm65hBHzvGrj93wEuVNIebvNIsJOlng3HFjpIxVqKGMCIfWIKGDE3YzK3p4LbGZ6\nNZFQWYJLNVf2M9CCJfbEImPYgvctrxl39H6KVYPCw1SAdaj9NneUqmREOQkKoEB0\nx6PmNirbMscHhQPSC0JQaqUgaQFgba1ALmzRYAnYhNb0twkTxWbY7DBkAarxqMIp\nyiLKcBFc5H7dgJCImo7us7aJeftC44uWkPIjw9AKH"),a("span",{class:"token operator"},"="),c("\n"),a("span",{class:"token operator"},"-"),a("span",{class:"token operator"},"-"),c("END CERTIFICAT"),a("span",{class:"token operator"},"-"),a("span",{class:"token operator"},"-"),c("\n"),a("span",{class:"token punctuation"},"["),a("span",{class:"token date number"},"Wed 30"),c(" Dec "),a("span",{class:"token number"},"2022"),c(),a("span",{class:"token time number"},"15:21:52"),c(" AM\n\n"),a("span",{class:"token number"},"3"),a("span",{class:"token punctuation"},"."),c(" Note"),a("span",{class:"token operator"},":"),c(" The certificate applied for here is a test certificate"),a("span",{class:"token punctuation"},","),c(" which cannot be used directly"),a("span",{class:"token punctuation"},"."),c(" It is only used to prove that your domain and configuration are correct"),a("span",{class:"token punctuation"},"."),c(" If you observe carefully"),a("span",{class:"token punctuation"},","),c(" you will find that the domain that issues the certificate to you is `"),a("span",{class:"token url"},"https://acme-staging-v02.api.letsencrypt.org`"),a("span",{class:"token punctuation"},","),c(" and this `staging` can be understood as a "),a("span",{class:"token string"},'"test server"'),a("span",{class:"token operator"},"!"),c("\n\n"),a("span",{class:"token number"},"4"),a("span",{class:"token punctuation"},"."),c(" If this step goes wrong"),a("span",{class:"token punctuation"},","),c(" you can run the following command to check the detailed application process and specific errors"),a("span",{class:"token punctuation"},"."),c(" If you don't understand"),a("span",{class:"token punctuation"},","),c(" you can hide sensitive information and ask in the Xray group"),a("span",{class:"token punctuation"},"."),c("\n\n```shell\n"),a("span",{class:"token domain constant"},"acme.sh"),c(),a("span",{class:"token operator"},"-"),a("span",{class:"token operator"},"-"),c("issue "),a("span",{class:"token operator"},"-"),a("span",{class:"token operator"},"-"),c("server letsencrypt "),a("span",{class:"token operator"},"-"),a("span",{class:"token operator"},"-"),c("test "),a("span",{class:"token operator"},"-"),c("d "),a("span",{class:"token domain constant"},"subdomain.yourdomain.com"),c(),a("span",{class:"token operator"},"-"),c("w "),a("span",{class:"token file-path string"},"/home/vpsadmin/www/webpage"),c(),a("span",{class:"token operator"},"-"),a("span",{class:"token operator"},"-"),c("keylength ec"),a("span",{class:"token operator"},"-"),a("span",{class:"token number"},"256"),c(),a("span",{class:"token operator"},"-"),a("span",{class:"token operator"},"-"),c("debug\n")])]),a("div",{class:"line-numbers"},[a("span",{class:"line-number"},"1"),a("br"),a("span",{class:"line-number"},"2"),a("br"),a("span",{class:"line-number"},"3"),a("br"),a("span",{class:"line-number"},"4"),a("br"),a("span",{class:"line-number"},"5"),a("br"),a("span",{class:"line-number"},"6"),a("br"),a("span",{class:"line-number"},"7"),a("br"),a("span",{class:"line-number"},"8"),a("br"),a("span",{class:"line-number"},"9"),a("br"),a("span",{class:"line-number"},"10"),a("br"),a("span",{class:"line-number"},"11"),a("br"),a("span",{class:"line-number"},"12"),a("br"),a("span",{class:"line-number"},"13"),a("br"),a("span",{class:"line-number"},"14"),a("br"),a("span",{class:"line-number"},"15"),a("br"),a("span",{class:"line-number"},"16"),a("br"),a("span",{class:"line-number"},"17"),a("br"),a("span",{class:"line-number"},"18"),a("br"),a("span",{class:"line-number"},"19"),a("br"),a("span",{class:"line-number"},"20"),a("br"),a("span",{class:"line-number"},"21"),a("br"),a("span",{class:"line-number"},"22"),a("br"),a("span",{class:"line-number"},"23"),a("br"),a("span",{class:"line-number"},"24"),a("br"),a("span",{class:"line-number"},"25"),a("br"),a("span",{class:"line-number"},"26"),a("br"),a("span",{class:"line-number"},"27"),a("br"),a("span",{class:"line-number"},"28"),a("br"),a("span",{class:"line-number"},"29"),a("br"),a("span",{class:"line-number"},"30"),a("br"),a("span",{class:"line-number"},"31"),a("br"),a("span",{class:"line-number"},"32"),a("br"),a("span",{class:"line-number"},"33"),a("br"),a("span",{class:"line-number"},"34"),a("br"),a("span",{class:"line-number"},"35"),a("br"),a("span",{class:"line-number"},"36"),a("br"),a("span",{class:"line-number"},"37"),a("br"),a("span",{class:"line-number"},"38"),a("br"),a("span",{class:"line-number"},"39"),a("br"),a("span",{class:"line-number"},"40"),a("br"),a("span",{class:"line-number"},"41"),a("br"),a("span",{class:"line-number"},"42"),a("br"),a("span",{class:"line-number"},"43"),a("br"),a("span",{class:"line-number"},"44"),a("br"),a("span",{class:"line-number"},"45"),a("br"),a("span",{class:"line-number"},"46"),a("br"),a("span",{class:"line-number"},"47"),a("br"),a("span",{class:"line-number"},"48"),a("br"),a("span",{class:"line-number"},"49"),a("br"),a("span",{class:"line-number"},"50"),a("br"),a("span",{class:"line-number"},"51"),a("br"),a("span",{class:"line-number"},"52"),a("br"),a("span",{class:"line-number"},"53"),a("br"),a("span",{class:"line-number"},"54"),a("br")])]),a("p",null,"(Note: This command is written in Chinese characters, therefore I have translated it into English. The command is used to issue SSL/TLS certificates using acme.sh client with Let's Encrypt CA in test mode for a subdomain of your domain with the specified webroot path, key length and in debug mode.)"),a("p",null,[c("Hmm, that's right. Just added a "),a("code",null,"--debug"),c(" parameter at the end of the command.")]),a("ol",{start:"5"},[a("li",null,"Once this step is confirmed to be successful, you can apply for the formal certificate. (The test certificate does not need to be deleted, as it will be automatically replaced by the formal certificate.)")]),a("h2",{id:"_6-4-application-for-official-certification",tabindex:"-1"},[a("a",{class:"header-anchor",href:"#_6-4-application-for-official-certification","aria-hidden":"true"},"#"),c(" 6.4 Application for Official Certification")]),a("ol",null,[a("li",null,[c("The command for applying for an official certificate is as follows (i.e., remove the "),a("code",null,"--test"),c(" parameter and add the "),a("code",null,"--force"),c(" parameter at the end):")])]),a("div",{class:"language-bash ext-sh line-numbers-mode"},[a("pre",{class:"language-bash"},[a("code",null,"acme.sh --set-default-ca --server letsencrypt\n")]),a("div",{class:"line-numbers"},[a("span",{class:"line-number"},"1"),a("br")])]),a("p",null,[c("This is a command in the shell language. It sets the default Certificate Authority (CA) to Let's Encrypt by using the "),a("code",null,"acme.sh"),c(" script.")]),a("div",{class:"language-bash ext-sh line-numbers-mode"},[a("pre",{class:"language-bash"},[a("code",null,"acme.sh --issue -d subdomain.yourdomain.com -w /home/vpsadmin/www/webpage --keylength ec-256 --force\n")]),a("div",{class:"line-numbers"},[a("span",{class:"line-number"},"1"),a("br")])]),a("p",null,'(Note: This is a command written in shell script that requests a SSL certificate from ACME server using the ACME client "acme.sh". It specifies the subdomain of the domain name, the web root directory of the website, the key length, and forces the re-issuance of the certificate.)'),a("div",{class:"custom-container warning"},[a("p",{class:"custom-container-title"},"Explanation"),a("p",null,[c("The meaning of the "),a("code",null,"--force"),c(' parameter is to manually (forcefully) update the certificate before the existing certificate expires. Although the certificate we applied for from the "test server" in the previous step cannot be used directly, it has not expired yet, so this parameter is needed.')])])],-1),L=a("ol",{start:"2"},[a("li",null,"You should eventually see a prompt that looks similar to the one above.")],-1),R=a("div",{class:"language-log ext-log line-numbers-mode"},[a("pre",{class:"language-log"},[a("code",null,[c("vpsadmin"),a("span",{class:"token operator"},"@"),c("vps"),a("span",{class:"token operator"},"-"),c("server"),a("span",{class:"token operator"},":"),a("span",{class:"token operator"},"~"),a("span",{class:"token operator"},"$"),c(),a("span",{class:"token domain constant"},"acme.sh"),c(),a("span",{class:"token operator"},"-"),a("span",{class:"token operator"},"-"),c("issue "),a("span",{class:"token operator"},"-"),c("d "),a("span",{class:"token domain constant"},"subdomain.yourdomain.com"),c(),a("span",{class:"token operator"},"-"),c("w "),a("span",{class:"token file-path string"},"/home/vpsadmin/www/webpage"),c(),a("span",{class:"token operator"},"-"),a("span",{class:"token operator"},"-"),c("keylength ec"),a("span",{class:"token operator"},"-"),a("span",{class:"token number"},"256"),c("\n"),a("span",{class:"token punctuation"},"["),a("span",{class:"token date number"},"Wed 30"),c(" Dec "),a("span",{class:"token number"},"2022"),c(),a("span",{class:"token time number"},"15:22:51"),c(" AM EST"),a("span",{class:"token punctuation"},"]"),c(),a("span",{class:"token property"},"Using CA:"),c(),a("span",{class:"token url"},"https://acme-v02.api.letsencrypt.org/directory"),c("\n"),a("span",{class:"token punctuation"},"["),a("span",{class:"token date number"},"Wed 30"),c(" Dec "),a("span",{class:"token number"},"2022"),c(),a("span",{class:"token time number"},"15:22:51"),c(" AM EST"),a("span",{class:"token punctuation"},"]"),c(" Creating domain key\n"),a("span",{class:"token punctuation"},"["),a("span",{class:"token date number"},"Wed 30"),c(" Dec "),a("span",{class:"token number"},"2022"),c(),a("span",{class:"token time number"},"15:22:51"),c(" AM EST"),a("span",{class:"token punctuation"},"]"),c(),a("span",{class:"token property"},"The domain key is here:"),c(),a("span",{class:"token file-path string"},"/home/vpsadmin/.acme.sh/subdomain.yourdomain.com_ecc/subdomain.yourdomain.com.key"),c("\n"),a("span",{class:"token punctuation"},"["),a("span",{class:"token date number"},"Wed 30"),c(" Dec "),a("span",{class:"token number"},"2022"),c(),a("span",{class:"token time number"},"15:22:51"),c(" AM EST"),a("span",{class:"token punctuation"},"]"),c(" Single domain"),a("span",{class:"token operator"},"="),a("span",{class:"token string"},"'subdomain.yourdomain.com'"),c("\n"),a("span",{class:"token punctuation"},"["),a("span",{class:"token date number"},"Wed 30"),c(" Dec "),a("span",{class:"token number"},"2022"),c(),a("span",{class:"token time number"},"15:22:51"),c(" AM EST"),a("span",{class:"token punctuation"},"]"),c(" Getting domain auth token for each domain\n"),a("span",{class:"token punctuation"},"["),a("span",{class:"token date number"},"Wed 30"),c(" Dec "),a("span",{class:"token number"},"2022"),c(),a("span",{class:"token time number"},"15:22:51"),c(" AM EST"),a("span",{class:"token punctuation"},"]"),c(" Getting webroot for domain"),a("span",{class:"token operator"},"="),a("span",{class:"token string"},"'subdomain.yourdomain.com'"),c("\n"),a("span",{class:"token punctuation"},"["),a("span",{class:"token date number"},"Wed 30"),c(" Dec "),a("span",{class:"token number"},"2022"),c(),a("span",{class:"token time number"},"15:22:51"),c(" AM EST"),a("span",{class:"token punctuation"},"]"),c(),a("span",{class:"token property"},"Verifying:"),c(),a("span",{class:"token domain constant"},"subdomain.yourdomain.com"),c("\n"),a("span",{class:"token punctuation"},"["),a("span",{class:"token date number"},"Wed 30"),c(" Dec "),a("span",{class:"token number"},"2022"),c(),a("span",{class:"token time number"},"15:22:51"),c(" AM EST"),a("span",{class:"token punctuation"},"]"),c(" Pending\n"),a("span",{class:"token punctuation"},"["),a("span",{class:"token date number"},"Wed 30"),c(" Dec "),a("span",{class:"token number"},"2022"),c(),a("span",{class:"token time number"},"15:22:51"),c(" AM EST"),a("span",{class:"token punctuation"},"]"),c(" Success\n"),a("span",{class:"token punctuation"},"["),a("span",{class:"token date number"},"Wed 30"),c(" Dec "),a("span",{class:"token number"},"2022"),c(),a("span",{class:"token time number"},"15:22:51"),c(" AM EST"),a("span",{class:"token punctuation"},"]"),c(" Verify finished"),a("span",{class:"token punctuation"},","),c(" start to sign"),a("span",{class:"token punctuation"},"."),c("\n"),a("span",{class:"token punctuation"},"["),a("span",{class:"token date number"},"Wed 30"),c(" Dec "),a("span",{class:"token number"},"2022"),c(),a("span",{class:"token time number"},"15:22:51"),c(" AM EST"),a("span",{class:"token punctuation"},"]"),c(" Lets finalize the order"),a("span",{class:"token punctuation"},"."),c("\n"),a("span",{class:"token punctuation"},"["),a("span",{class:"token date number"},"Wed 30"),c(" Dec "),a("span",{class:"token number"},"2022"),c(),a("span",{class:"token time number"},"15:22:51"),c(" AM EST"),a("span",{class:"token punctuation"},"]"),c(" Le_OrderFinalize"),a("span",{class:"token operator"},"="),a("span",{class:"token string"},"'https://acme-v02.api.letsencrypt.org/acme/finalize/490205996/7730242872'"),c("\n"),a("span",{class:"token punctuation"},"["),a("span",{class:"token date number"},"Wed 30"),c(" Dec "),a("span",{class:"token number"},"2022"),c(),a("span",{class:"token time number"},"15:22:51"),c(" AM EST"),a("span",{class:"token punctuation"},"]"),c(" Downloading cert"),a("span",{class:"token punctuation"},"."),c("\n"),a("span",{class:"token punctuation"},"["),a("span",{class:"token date number"},"Wed 30"),c(" Dec "),a("span",{class:"token number"},"2022"),c(),a("span",{class:"token time number"},"15:22:51"),c(" AM EST"),a("span",{class:"token punctuation"},"]"),c(" Le_LinkCert"),a("span",{class:"token operator"},"="),a("span",{class:"token string"},"'https://acme-v02.api.letsencrypt.org/acme/cert/vsxvk0oldnuobe51ayxz4dms62sk2dwmw9zhuw'"),c("\n"),a("span",{class:"token punctuation"},"["),a("span",{class:"token date number"},"Wed 30"),c(" Dec "),a("span",{class:"token number"},"2022"),c(),a("span",{class:"token time number"},"15:22:51"),c(" AM EST"),a("span",{class:"token punctuation"},"]"),c(" Cert success"),a("span",{class:"token punctuation"},"."),c("\n"),a("span",{class:"token operator"},"-"),a("span",{class:"token operator"},"-"),c("BEGIN CERTIFICAT"),a("span",{class:"token operator"},"-"),a("span",{class:"token operator"},"-"),c("\nsxlYqPvWreKgD5b8JyOQX0Yg2MLoRUoDyqVkd31PthIiwzdckoh5eD3JU7ysYBtN\ncTFK4LGOfjqi8Ks87EVJdK9IaSAu7ZC6h5to0eqpJ5PLhaM3e6yJBbHmYA8w1Smp\nwAb3tdoHZ9ttUIm9CrSzvDBt6BBT6GqYdDamMyCYBLooMyDEM4CUFsOzCRrEqqvC\n2mTTEmhvpojo5rhdTSJxibozyNWTGwoTj0v9pTUeQcGqLIzqi4DowjBHD5guwRid\nSjAFnm6JT2xUQgWFm58A1gv1OhbH1TRPUUmtE1nFEN7YiSjI4xgxqAXT3CLD2EUb\nwXlUrO6c75zSsQP4bRMzgOjJUqHtSb6IEqELzt4M7KzL5iCOruCChCo2DZxUwvVX\ntOoaAyQJzCbTqE6aUqwiKi3gVyoxvDP9mI5JdRYzsDL6GVud7EHPnYeMl9ubLZAK\n0vg84mbMP3f6mYM4KRa1cqiyOIcQPT4AzGFYVv4sm049bZQg7sd0Bz9CaFvE7yDA\n1y17XlgCDnsjxl66bqI1vkENN9XT5xeFHONqc18b5fZEKSIvdX7iWPFWp1PyMPpG\n0pMCP1EymZNFxIMJLgbWqExwLWfPc5Ib3PjBaIqhXPnw6sT2MQSxXwDupq1UJVhV\n7E3hQRVlwI4CXi6WLHJMNvNRyyK87gCrLH1bKYsPeRVaz77poWBq49zwBCts6hPY\nIeF4ltGXyANNIOPEi8vy138fRU4LYh81d8FjOtFfJZogMjwhfNvapqxPMsioPlmX\nTnZu0n7setrVNUEfTMHWqPpDgk5MPrWLA4LapqaDfEX4pwnQJLMwMi6s94z165c0\niMRSKA1yU5zqv8aNsDfPoY4OkSPWs4MaXgRRSLBsUfZ15DwQXPk76kegHIyxWvwF\ntYw9HKR5QCMK66fa0z4aJoFVFLK0IIOGEZOanRFUCnkLUDd3QZ3YU8lEcrj7Uxos\nhaiRNICyC6UfsCJ94a8vcNyMosPv3xBLMp19WXgiFYqEFQkntkv1FLRI35fjeJmg\n0fmD9VG9bkzGPHihJgQLRlCHasGf6XrdfkSsODAyCUHUHJ0RzqF4YEZMcxDxzuQ2\nYO7bFwj7S3mUdVPZ6MPasjxdyBjJgEBMch2uy4AhmudXfEBQBye8W6ZI4ztZjLVV\nFmP4SIuaNUmMe20TjR8b9NVC96AhxOanWT3mRROsdokpKQGTJvl27EHH8KuAbUOc\nG6KtPy4wslNZNXWcBy9n63RcWak12r7kAIFn38tZxmlw2WUKoRSMAH64GcDTjRQd\nAm65hBHzvGrj93wEuVNIebvNIsJOlng3HFjpIxVqKGMCIfWIKGDE3YzK3p4LbGZ6\nNZFQWYJLNVf2M9CCJfbEImPYgvctrxl39H6KVYPCw1SAdaj9NneUqmREOQkKoEB0\nx6PmNirbMscHhQPSC0JQaqUgaQFgba1ALmzRYAnYhNb0twkTxWbY7DBkAarxqMIp\nyiLKcBFc5H7dgJCImo7us7aJeftC44uWkPM"),a("span",{class:"token operator"},"="),c("\n"),a("span",{class:"token operator"},"-"),a("span",{class:"token operator"},"-"),c("END CERTIFICAT"),a("span",{class:"token operator"},"-"),a("span",{class:"token operator"},"-"),c("\n"),a("span",{class:"token punctuation"},"["),a("span",{class:"token date number"},"Wed 30"),c(" Dec "),a("span",{class:"token number"},"2022"),c(),a("span",{class:"token time number"},"15:22:52"),c(" AM EST"),a("span",{class:"token punctuation"},"]"),c(" Your cert is in "),a("span",{class:"token file-path string"},"/home/vpsadmin/.acme.sh/subdomain.yourdomain.com_ecc/subdomain.yourdomain.com.cer"),c("\n"),a("span",{class:"token punctuation"},"["),a("span",{class:"token date number"},"Wed 30"),c(" Dec "),a("span",{class:"token number"},"2022"),c(),a("span",{class:"token time number"},"15:22:52"),c(" AM EST"),a("span",{class:"token punctuation"},"]"),c(" Your cert key is in "),a("span",{class:"token file-path string"},"/home/vpsadmin/.acme.sh/subdomain.yourdomain.com_ecc/subdomain.yourdomain.com.key"),c("\n"),a("span",{class:"token punctuation"},"["),a("span",{class:"token date number"},"Wed 30"),c(" Dec "),a("span",{class:"token number"},"2022"),c(),a("span",{class:"token time number"},"15:22:52"),c(" AM EST"),a("span",{class:"token punctuation"},"]"),c(" The intermediate CA cert is in "),a("span",{class:"token file-path string"},"/home/vpsadmin/.acme.sh/subdomain.yourdomain.com_ecc/ca.cer"),c("\n"),a("span",{class:"token punctuation"},"["),a("span",{class:"token date number"},"Wed 30"),c(" Dec "),a("span",{class:"token number"},"2022"),c(),a("span",{class:"token time number"},"15:22:52"),c(" AM EST"),a("span",{class:"token punctuation"},"]"),c(),a("span",{class:"token property"},"And the full chain certs is there:"),c(),a("span",{class:"token file-path string"},"/home/vpsadmin/.acme.sh/subdomain.yourdomain.com_ecc/fullchain.cer"),c("\n")])]),a("div",{class:"line-numbers"},[a("span",{class:"line-number"},"1"),a("br"),a("span",{class:"line-number"},"2"),a("br"),a("span",{class:"line-number"},"3"),a("br"),a("span",{class:"line-number"},"4"),a("br"),a("span",{class:"line-number"},"5"),a("br"),a("span",{class:"line-number"},"6"),a("br"),a("span",{class:"line-number"},"7"),a("br"),a("span",{class:"line-number"},"8"),a("br"),a("span",{class:"line-number"},"9"),a("br"),a("span",{class:"line-number"},"10"),a("br"),a("span",{class:"line-number"},"11"),a("br"),a("span",{class:"line-number"},"12"),a("br"),a("span",{class:"line-number"},"13"),a("br"),a("span",{class:"line-number"},"14"),a("br"),a("span",{class:"line-number"},"15"),a("br"),a("span",{class:"line-number"},"16"),a("br"),a("span",{class:"line-number"},"17"),a("br"),a("span",{class:"line-number"},"18"),a("br"),a("span",{class:"line-number"},"19"),a("br"),a("span",{class:"line-number"},"20"),a("br"),a("span",{class:"line-number"},"21"),a("br"),a("span",{class:"line-number"},"22"),a("br"),a("span",{class:"line-number"},"23"),a("br"),a("span",{class:"line-number"},"24"),a("br"),a("span",{class:"line-number"},"25"),a("br"),a("span",{class:"line-number"},"26"),a("br"),a("span",{class:"line-number"},"27"),a("br"),a("span",{class:"line-number"},"28"),a("br"),a("span",{class:"line-number"},"29"),a("br"),a("span",{class:"line-number"},"30"),a("br"),a("span",{class:"line-number"},"31"),a("br"),a("span",{class:"line-number"},"32"),a("br"),a("span",{class:"line-number"},"33"),a("br"),a("span",{class:"line-number"},"34"),a("br"),a("span",{class:"line-number"},"35"),a("br"),a("span",{class:"line-number"},"36"),a("br"),a("span",{class:"line-number"},"37"),a("br"),a("span",{class:"line-number"},"38"),a("br"),a("span",{class:"line-number"},"39"),a("br"),a("span",{class:"line-number"},"40"),a("br"),a("span",{class:"line-number"},"41"),a("br"),a("span",{class:"line-number"},"42"),a("br"),a("span",{class:"line-number"},"43"),a("br"),a("span",{class:"line-number"},"44"),a("br"),a("span",{class:"line-number"},"45"),a("br"),a("span",{class:"line-number"},"46"),a("br")])],-1),q=a("ol",{start:"3"},[a("li",null,[c("If you observe carefully, you will find that the domain name that issues the certificate to you this time is "),a("code",null,"https://acme-v02.api.letsencrypt.org"),c(", which lacks the word "),a("code",null,"staging"),c(". Therefore, this is the [Production Environment]!")])],-1),U=a("h2",{id:"_6-5-certificate-installation",tabindex:"-1"},[a("a",{class:"header-anchor",href:"#_6-5-certificate-installation","aria-hidden":"true"},"#"),c(" 6.5 Certificate Installation")],-1),N=a("ol",null,[a("li",null,"After completing the certificate application, it needs to be installed to a specified location and referenced in the configuration file to take effect:")],-1),F=a("div",{class:"language-bash ext-sh line-numbers-mode"},[a("pre",{class:"language-bash"},[a("code",null,[c("vpsadmin@vps-server:~$ acme.sh --installcert -d subdomain.yourdomain.com --cert-file /path/to/install/cert.crt --key-file /path/to/install/cert.key --fullchain-file /path/to/install/fullchain.crt --ecc\n"),a("span",{class:"token punctuation"},"["),c("Mon "),a("span",{class:"token number"},"14"),c(" Feb "),a("span",{class:"token number"},"2022"),c(" 03:00:25 PM CST"),a("span",{class:"token punctuation"},"]"),c(" Installing cert to: /etc/xray/cert/cert.crt\n"),a("span",{class:"token punctuation"},"["),c("Mon "),a("span",{class:"token number"},"14"),c(" Feb "),a("span",{class:"token number"},"2022"),c(" 03:00:25 PM CST"),a("span",{class:"token punctuation"},"]"),c(" Installing key to: /etc/xray/cert/cert.key\n"),a("span",{class:"token punctuation"},"["),c("Mon "),a("span",{class:"token number"},"14"),c(" Feb "),a("span",{class:"token number"},"2022"),c(" 03:00:25 PM CST"),a("span",{class:"token punctuation"},"]"),c(" Installing full chain to: /etc/xray/cert/fullchain.crt\n")])]),a("div",{class:"line-numbers"},[a("span",{class:"line-number"},"1"),a("br"),a("span",{class:"line-number"},"2"),a("br"),a("span",{class:"line-number"},"3"),a("br"),a("span",{class:"line-number"},"4"),a("br")])],-1),z=a("p",null,"(Note: This is a shell command for installing a SSL certificate using acme.sh. The command is specifying the domain, file paths for the certificate, private key, and full chain, as well as indicating that an ECC certificate should be used.)",-1),Y=a("h2",{id:"_6-6-your-progress",tabindex:"-1"},[a("a",{class:"header-anchor",href:"#_6-6-your-progress","aria-hidden":"true"},"#"),c(" 6.6 Your Progress")],-1),J=a("p",null,"At this point, the two basic infrastructures required by Xray are finally in place! Xray, which has been eagerly awaited, is about to be revealed, and we are finally about to enter the most exciting chapter!",-1),H=a("blockquote",null,[a("p",null,"⬛⬛⬛⬛⬛⬛⬜⬜ 75%")],-1);l.render=function(c,l){const K=n("OutboundLink");return e(),s(o,null,[r,i,p,u,a("p",null,[m,a("a",b,[d,t(K)]),k]),h,f,g,y,v,w,E,T,M,C,A,x,S,D,I,W,P,L,R,q,U,N,F,z,Y,J,H],64)};export default l;
